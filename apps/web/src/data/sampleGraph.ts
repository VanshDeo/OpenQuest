import type { ArchGraph } from "@/types/ArchGraphTypes";

/**
 * Sample progressive disclosure graph — Next.js architecture
 * Depth 0: 5 clusters
 * Depth 1: modules/services within clusters
 * Depth 2: files within modules
 */
export const sampleGraph: ArchGraph = {
    repository: "vercel/next.js",
    summary:
        "Full-stack React framework with hybrid rendering, file-based routing, and edge middleware",
    architecturePattern: "layered",
    systemType: "web-app",
    complexityScore: 8,

    progressiveStructure: {
        maxDepth: 2,
        rootNodes: [
            "cluster_core",
            "cluster_routing",
            "cluster_rendering",
            "cluster_compiler",
            "cluster_data",
        ],
        defaultViewDepth: 0,
        expansionStrategy: "click-to-expand",
        recommendedStartNodes: ["cluster_core"],
    },

    nodes: [
        // ══════════════════════════════════════
        // DEPTH 0: Clusters (top-level folders)
        // ══════════════════════════════════════
        {
            id: "cluster_core",
            label: "Core Application",
            type: "cluster",
            description: "Server bootstrap, CLI entry, and request lifecycle",
            parentId: null,
            children: ["mod_entry", "mod_server"],
            isExpandable: true,
            defaultExpanded: false,
            depth: 0,
            childCount: 2,
            visualHint: "folder-collapsed",
            layer: "api",
            importance: 1.0,
            complexity: 0.6,
            size: 10,
            tags: ["entry", "server", "bootstrap"],
        },
        {
            id: "cluster_routing",
            label: "Routing & Middleware",
            type: "cluster",
            description: "File-system routing, API routes, and edge middleware",
            parentId: null,
            children: ["mod_router", "mod_middleware", "mod_api_routes"],
            isExpandable: true,
            defaultExpanded: false,
            depth: 0,
            childCount: 3,
            visualHint: "folder-collapsed",
            layer: "api",
            importance: 0.9,
            complexity: 0.7,
            size: 9,
            tags: ["routing", "middleware", "api"],
        },
        {
            id: "cluster_rendering",
            label: "Rendering Engine",
            type: "cluster",
            description: "SSR, SSG, ISR, and React Server Components streaming",
            parentId: null,
            children: ["mod_ssr", "mod_ssg", "mod_streaming"],
            isExpandable: true,
            defaultExpanded: false,
            depth: 0,
            childCount: 3,
            visualHint: "folder-collapsed",
            layer: "service",
            importance: 0.95,
            complexity: 0.9,
            size: 9,
            tags: ["ssr", "ssg", "streaming", "react"],
        },
        {
            id: "cluster_compiler",
            label: "Build Pipeline",
            type: "cluster",
            description: "SWC compiler, Webpack/Turbopack bundlers, and optimization",
            parentId: null,
            children: ["mod_swc", "mod_webpack", "mod_turbopack"],
            isExpandable: true,
            defaultExpanded: false,
            depth: 0,
            childCount: 3,
            visualHint: "folder-collapsed",
            layer: "infra",
            importance: 0.7,
            complexity: 0.85,
            size: 8,
            tags: ["compiler", "bundler", "build"],
        },
        {
            id: "cluster_data",
            label: "Data & Caching",
            type: "cluster",
            description: "Data fetching, cache management, and image optimization",
            parentId: null,
            children: ["mod_fetch", "mod_cache", "mod_image"],
            isExpandable: true,
            defaultExpanded: false,
            depth: 0,
            childCount: 3,
            visualHint: "folder-collapsed",
            layer: "data",
            importance: 0.65,
            complexity: 0.5,
            size: 7,
            tags: ["data", "cache", "fetch"],
        },

        // ══════════════════════════════════════
        // DEPTH 1: Modules (revealed on expand)
        // ══════════════════════════════════════

        // ── Core ──
        {
            id: "mod_entry",
            label: "CLI Entry",
            type: "entry",
            description: "next dev / next build / next start entry points",
            parentId: "cluster_core",
            children: ["file_cli_ts", "file_bin_ts"],
            isExpandable: true,
            defaultExpanded: false,
            depth: 1,
            childCount: 2,
            visualHint: "folder-collapsed",
            layer: "api",
            importance: 1.0,
            complexity: 0.4,
            size: 7,
            tags: ["entry", "cli"],
        },
        {
            id: "mod_server",
            label: "Next Server",
            type: "service",
            description: "Core HTTP server and request lifecycle management",
            parentId: "cluster_core",
            children: ["file_next_server_ts", "file_request_handler_ts"],
            isExpandable: true,
            defaultExpanded: false,
            depth: 1,
            childCount: 2,
            visualHint: "folder-collapsed",
            layer: "api",
            importance: 0.95,
            complexity: 0.8,
            size: 8,
            tags: ["server", "http", "lifecycle"],
        },

        // ── Routing ──
        {
            id: "mod_router",
            label: "File Router",
            type: "controller",
            description: "File-system based route resolution engine",
            parentId: "cluster_routing",
            children: ["file_router_ts", "file_route_matcher_ts"],
            isExpandable: true,
            defaultExpanded: false,
            depth: 1,
            childCount: 2,
            visualHint: "folder-collapsed",
            layer: "api",
            importance: 0.85,
            complexity: 0.7,
            size: 7,
            tags: ["routing", "filesystem"],
        },
        {
            id: "mod_middleware",
            label: "Edge Middleware",
            type: "service",
            description: "Edge middleware execution engine",
            parentId: "cluster_routing",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 1,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "api",
            importance: 0.75,
            complexity: 0.6,
            size: 6,
            tags: ["middleware", "edge"],
        },
        {
            id: "mod_api_routes",
            label: "API Routes",
            type: "api",
            description: "API route handler and request parsing",
            parentId: "cluster_routing",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 1,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "api",
            importance: 0.7,
            complexity: 0.5,
            size: 5,
            tags: ["api", "routes"],
        },

        // ── Rendering ──
        {
            id: "mod_ssr",
            label: "SSR Pipeline",
            type: "service",
            description: "Server-side rendering pipeline with React DOM",
            parentId: "cluster_rendering",
            children: ["file_render_ts", "file_html_ts"],
            isExpandable: true,
            defaultExpanded: false,
            depth: 1,
            childCount: 2,
            visualHint: "folder-collapsed",
            layer: "service",
            importance: 0.9,
            complexity: 0.9,
            size: 8,
            tags: ["ssr", "rendering", "react"],
        },
        {
            id: "mod_ssg",
            label: "Static Generation",
            type: "service",
            description: "SSG and ISR logic with full-route caching",
            parentId: "cluster_rendering",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 1,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "service",
            importance: 0.8,
            complexity: 0.7,
            size: 7,
            tags: ["ssg", "isr", "static"],
        },
        {
            id: "mod_streaming",
            label: "RSC Streaming",
            type: "service",
            description: "React Server Components streaming and Suspense",
            parentId: "cluster_rendering",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 1,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "service",
            importance: 0.75,
            complexity: 0.8,
            size: 7,
            tags: ["streaming", "rsc", "suspense"],
        },

        // ── Compiler ──
        {
            id: "mod_swc",
            label: "SWC Compiler",
            type: "infra",
            description: "SWC-based TypeScript and JSX transform",
            parentId: "cluster_compiler",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 1,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "infra",
            importance: 0.7,
            complexity: 0.8,
            size: 7,
            tags: ["swc", "compiler", "typescript"],
        },
        {
            id: "mod_webpack",
            label: "Webpack Config",
            type: "infra",
            description: "Webpack bundler configuration and plugins",
            parentId: "cluster_compiler",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 1,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "infra",
            importance: 0.65,
            complexity: 0.7,
            size: 6,
            tags: ["webpack", "bundler"],
        },
        {
            id: "mod_turbopack",
            label: "Turbopack",
            type: "infra",
            description: "Turbopack incremental bundler engine",
            parentId: "cluster_compiler",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 1,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "infra",
            importance: 0.6,
            complexity: 0.9,
            size: 6,
            tags: ["turbopack", "incremental"],
        },

        // ── Data ──
        {
            id: "mod_fetch",
            label: "Data Fetching",
            type: "service",
            description: "Extended fetch with revalidation and deduplication",
            parentId: "cluster_data",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 1,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "data",
            importance: 0.65,
            complexity: 0.4,
            size: 5,
            tags: ["fetch", "data"],
        },
        {
            id: "mod_cache",
            label: "Cache Handler",
            type: "infra",
            description: "Full-route and data cache management",
            parentId: "cluster_data",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 1,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "data",
            importance: 0.6,
            complexity: 0.5,
            size: 5,
            tags: ["cache", "revalidation"],
        },
        {
            id: "mod_image",
            label: "Image Optimizer",
            type: "service",
            description: "On-demand image optimization pipeline",
            parentId: "cluster_data",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 1,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "data",
            importance: 0.5,
            complexity: 0.6,
            size: 4,
            tags: ["image", "optimization"],
        },

        // ══════════════════════════════════════
        // DEPTH 2: Files (revealed on module expand)
        // ══════════════════════════════════════

        // Core → CLI Entry
        {
            id: "file_cli_ts",
            label: "cli.ts",
            type: "entry",
            description: "CLI argument parsing and command dispatch",
            parentId: "mod_entry",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 2,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "api",
            importance: 0.8,
            complexity: 0.3,
            size: 4,
            tags: ["cli", "entry"],
        },
        {
            id: "file_bin_ts",
            label: "next-bin.ts",
            type: "entry",
            description: "Binary entry point (npx next)",
            parentId: "mod_entry",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 2,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "api",
            importance: 0.6,
            complexity: 0.2,
            size: 3,
            tags: ["binary", "npx"],
        },

        // Core → Server
        {
            id: "file_next_server_ts",
            label: "next-server.ts",
            type: "service",
            description: "Main server class with request handling pipeline",
            parentId: "mod_server",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 2,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "api",
            importance: 0.95,
            complexity: 0.8,
            size: 6,
            tags: ["server", "http"],
        },
        {
            id: "file_request_handler_ts",
            label: "request-handler.ts",
            type: "controller",
            description: "Incoming request routing and response pipeline",
            parentId: "mod_server",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 2,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "api",
            importance: 0.8,
            complexity: 0.7,
            size: 5,
            tags: ["request", "handler"],
        },

        // Routing → File Router
        {
            id: "file_router_ts",
            label: "router.ts",
            type: "controller",
            description: "Route tree builder from file system",
            parentId: "mod_router",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 2,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "api",
            importance: 0.8,
            complexity: 0.6,
            size: 5,
            tags: ["router", "filesystem"],
        },
        {
            id: "file_route_matcher_ts",
            label: "route-matcher.ts",
            type: "service",
            description: "URL pattern matching and parameter extraction",
            parentId: "mod_router",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 2,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "api",
            importance: 0.7,
            complexity: 0.5,
            size: 4,
            tags: ["matching", "params"],
        },

        // Rendering → SSR
        {
            id: "file_render_ts",
            label: "render.ts",
            type: "service",
            description: "Core React SSR render-to-stream pipeline",
            parentId: "mod_ssr",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 2,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "service",
            importance: 0.9,
            complexity: 0.9,
            size: 6,
            tags: ["render", "stream", "react"],
        },
        {
            id: "file_html_ts",
            label: "html-renderer.ts",
            type: "service",
            description: "HTML document assembly and head injection",
            parentId: "mod_ssr",
            children: [],
            isExpandable: false,
            defaultExpanded: false,
            depth: 2,
            childCount: 0,
            visualHint: "leaf-node",
            layer: "service",
            importance: 0.7,
            complexity: 0.5,
            size: 4,
            tags: ["html", "head", "document"],
        },
    ],

    edges: [
        // ── Depth 0: Cluster-level (always visible) ──
        { source: "cluster_core", target: "cluster_routing", relationship: "calls", strength: 0.95, direction: "forward", visibleAtDepth: 0 },
        { source: "cluster_core", target: "cluster_compiler", relationship: "depends_on", strength: 0.7, direction: "forward", visibleAtDepth: 0 },
        { source: "cluster_routing", target: "cluster_rendering", relationship: "calls", strength: 0.9, direction: "forward", visibleAtDepth: 0 },
        { source: "cluster_rendering", target: "cluster_data", relationship: "reads_from", strength: 0.8, direction: "forward", visibleAtDepth: 0 },
        { source: "cluster_data", target: "cluster_compiler", relationship: "depends_on", strength: 0.5, direction: "forward", visibleAtDepth: 0 },

        // ── Depth 1: Module-level ──
        { source: "mod_entry", target: "mod_server", relationship: "calls", strength: 1.0, direction: "forward", visibleAtDepth: 1 },
        { source: "mod_server", target: "mod_router", relationship: "calls", strength: 0.9, direction: "forward", visibleAtDepth: 1 },
        { source: "mod_server", target: "mod_middleware", relationship: "calls", strength: 0.8, direction: "forward", visibleAtDepth: 1 },
        { source: "mod_router", target: "mod_ssr", relationship: "calls", strength: 0.9, direction: "forward", visibleAtDepth: 1 },
        { source: "mod_router", target: "mod_ssg", relationship: "calls", strength: 0.85, direction: "forward", visibleAtDepth: 1 },
        { source: "mod_router", target: "mod_api_routes", relationship: "calls", strength: 0.8, direction: "forward", visibleAtDepth: 1 },
        { source: "mod_ssr", target: "mod_streaming", relationship: "calls", strength: 0.8, direction: "forward", visibleAtDepth: 1 },
        { source: "mod_ssr", target: "mod_fetch", relationship: "calls", strength: 0.7, direction: "forward", visibleAtDepth: 1 },
        { source: "mod_ssg", target: "mod_cache", relationship: "writes_to", strength: 0.8, direction: "forward", visibleAtDepth: 1 },
        { source: "mod_fetch", target: "mod_cache", relationship: "reads_from", strength: 0.7, direction: "forward", visibleAtDepth: 1 },

        // ── Depth 2: File-level ──
        { source: "file_cli_ts", target: "file_next_server_ts", relationship: "calls", strength: 0.9, direction: "forward", visibleAtDepth: 2 },
        { source: "file_next_server_ts", target: "file_request_handler_ts", relationship: "calls", strength: 0.9, direction: "forward", visibleAtDepth: 2 },
        { source: "file_request_handler_ts", target: "file_router_ts", relationship: "calls", strength: 0.85, direction: "forward", visibleAtDepth: 2 },
        { source: "file_router_ts", target: "file_route_matcher_ts", relationship: "imports", strength: 0.8, direction: "forward", visibleAtDepth: 2 },
        { source: "file_router_ts", target: "file_render_ts", relationship: "calls", strength: 0.9, direction: "forward", visibleAtDepth: 2 },
    ],

    visualization: {
        initialView: "clusters-only",
        cameraFocus: "cluster_core",
        layoutStyle: "hierarchical-tree",
        expansionAnimation: "zoom-and-unfold",
        collapseAnimation: "fold-and-zoom-out",
        expansionDuration: 400,
        layoutEngine: "force-directed-hierarchical",
    },

    tags: ["react", "framework", "ssr", "ssg", "typescript", "webpack", "turbopack"],

    metadata: {
        totalNodes: 27,
        visibleNodesAtStart: 5,
        maxDepthAvailable: 2,
        analysisConfidence: 0.88,
        warnings: [
            "High complexity in rendering cluster — SSR + streaming + ISR overlap",
        ],
    },
};
